# Module 8 - Sniffing

## concepts
- network sniffing
    - types of ethernet
        - shared
        - switched
            - ARP spoofing
            - MAC flooding
- types of sniffing
    - passive sniffing (hub environment)
        - compromising phisical security
        - using a trojan horse
        - Passive sniffing provides significant stealth advantages over active sniffing
    - active sniffing (switch environment)
        - MAC flooding
        - DNS poisoning
        - ARP poisoning 
        - DHCP attacks 
        - Switch port stealing 
        - Spoofing attack
- vulnerable (that send info in clear text)
    - telnet
    - rlogin
    - http
    - pop
    - imap
    - smtp
    - nntp
    - ftp
- hardware protocol analyzer
    - Voyager M4x Protocol Analyzer 
    - N2X N5540A Agilent Protocol Analyzer
- span port
- wiretapping (or tehephone tapping)
    - active (MITM)
    - passive (snooping or eavesdropping)
- lawful interception
- sniffing techniques
    - mac 
        - 48 bits: 24 bits for OUI (Organization Unique Identifier), 24 bits for NIC specific
        - CAM table
        - sniffing
            - flooding (flooding the CAM table)
            - switch port stealing
            - spoofing (and defense technique using snooping table)
    - dhcp
        - starvation attack
        - rogue server attack
    - arp
        - spoofing attack
        - poisoning attack
    - IRDP (ICMP Router Discovery Protocol) spoofing 
    - VLAN Hopping
        - switch spoofing
        - double tagging
    - STP (Spanning Tree Protocol) attack
    - DNS
        - poisoning
        - spoofing
        - difference between intranet and internet
        - cache poisoning
- How to defend agains MAC spoofing
    - DHCP snooping bind table
    - Dynamic ARP inspection
    - IP Source guard
    - Encryption
    - Retrieval of MAC address
    - Implementation of IEEE 802.1X Suites
    - AAA (Authentication, Authorization and Accounting)
- sniffing detection
    - nmap 'sniffer-detect' script (promiscious)

### wireshark special
- filters
    - 'pop' to filter by protocol
    - 'ip.addr' to filter by ip address
    - 'ip.src' to filter by ip address
    - 'ip.dst' to filter by ip address

## tools
- macof (MAC flooding)
- yearsinia (DHCP starvation attack)
- XArp (ARP spoofing detection tools)
- wireshark